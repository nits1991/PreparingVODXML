Imports System
Imports System.IO
Imports System.Xml

Public Class Form1
	Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
		TextBox3.Text = "U"
		TextBox9.Text = "Documentary"
		TextBox10.Text = "TV Shows"
		TextBox12.Text = "10.3.40.55:8080"
		TextBox13.Text = "19"
		PictureBox1.Hide()
		PictureBox2.Hide()
	End Sub
	Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
		Dim folderpath As String
		If TextBox14.Text.Length = 0 Then
			Dim result As DialogResult = FolderBrowserDialog1.ShowDialog()
			folderpath = FolderBrowserDialog1.SelectedPath()
			TextBox14.Text = FolderBrowserDialog1.SelectedPath()
			'MessageBox.Show(folderpath)
		Else
			folderpath = TextBox14.Text
		End If
		Dim free_vod_xml As String = folderpath + "\" & TextBox1.Text & ".xml"
		Dim Subscription_xml As String = folderpath + "\" & TextBox1.Text & "_sub" & ".xml"

		System.IO.File.WriteAllText(free_vod_xml, "<?xml version=""1.0"" encoding=""UTF-8""?><ADI3 xmlns=""urn:cablelabs:md:xsd:core:3.0"" xmlns:content=""urn:cablelabs:md:xsd:content:3.0"" xmlns:core=""urn:cablelabs:md:xsd:core:3.0"" xmlns:offer=""urn:cablelabs:md:xsd:offer:3.0"" xmlns:terms=""urn:cablelabs:md:xsd:terms:3.0"" xmlns:title=""urn:cablelabs:md:xsd:title:3.0"" xmlns:irdeto=""http://www.irdeto.com/schemas/metadata/1.0"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xsi:schemaLocation=""urn:cablelabs:md:xsd:core:3.0 MD-SP-CORE-I02.xsd urn:cablelabs:md:xsd:offer:3.0 MD-SP-OFFER-I02.xsd urn:cablelabs:md:xsd:title:3.0 MD-SP-TITLE-I02.xsd urn:cablelabs:md:xsd:content:3.0 MD-SP-CONTENT-I02.xsd urn:cablelabs:md:xsd:terms:3.0 MD-SP-TERMS-I02.xsd http://www.irdeto.com/schemas/metadata/1.0 Irdeto-ADI-3_0-extension.xsd"">" & Environment.NewLine & "")

		System.IO.File.AppendAllText(free_vod_xml, String.Format("<Asset xsi:type=""offer:OfferType"" uriId=""irdeto.com/Offer/{0:S}Movie"" providerVersionNum=""12"" internalVersionNum=""12"" creationDateTime= ""2016-08-30T00:00:00Z"" startDateTime=""2015-03-25T00:00:00Z"" endDateTime=""2020-12-31T00:00:00Z"">" & Environment.NewLine & "", TextBox1.Text))

		System.IO.File.AppendAllText(free_vod_xml, String.Format("<offer:PromotionalContentGroupRef uriId=""irdeto.com/ContentGroup/{0:S}"" /><offer:ProviderContentTier>PDL Economy</offer:ProviderContentTier><offer:BillingId>10015</offer:BillingId><offer:TermsRef uriId=""irdeto.com/Terms/{0:S}Movie"" /><offer:ContentGroupRef uriId=""irdeto.com/ContentGroup/{0:S}"" /></Asset>" & Environment.NewLine & "", TextBox1.Text))


		If CheckBox1.Checked Then
			System.IO.File.AppendAllText(free_vod_xml, String.Format("<Asset xsi:type=""offer:OfferType"" uriId=""irdeto.com/Offer/{0:S}Preview"" providerVersionNum=""12"" internalVersionNum=""12"" creationDateTime= ""2016-08-30T00:00:00Z"" startDateTime=""2015-03-25T00:00:00Z"" endDateTime=""2020-12-31T00:00:00Z"">" & Environment.NewLine & "", TextBox1.Text))

			System.IO.File.AppendAllText(free_vod_xml, String.Format("<offer:PromotionalContentGroupRef uriId=""irdeto.com/ContentGroup/{0:S}"" /><offer:ProviderContentTier>PDL Economy</offer:ProviderContentTier><offer:BillingId>10015</offer:BillingId><offer:TermsRef uriId=""irdeto.com/Terms/{0:S}Preview"" /><offer:ContentGroupRef uriId=""irdeto.com/ContentGroup/{0:S}"" /></Asset>" & Environment.NewLine & "", TextBox1.Text))
		End If

		System.IO.File.AppendAllText(free_vod_xml, String.Format("<Asset xsi:type=""terms:TermsType"" uriId=""irdeto.com/Terms/{0:S}Movie"" providerVersionNum=""12"" internalVersionNum=""12"" creationDateTime=""2016-08-30T00:00:00Z"" startDateTime=""2015-03-25T00:00:00Z"" endDateTime=""2020-12-31T00:00:00Z""><terms:ContractName>{1:S}</terms:ContractName><terms:SuggestedPrice xml:lang=""01"">0.00</terms:SuggestedPrice></Asset>" & Environment.NewLine & "", TextBox1.Text, TextBox2.Text))

		If CheckBox1.Checked Then
			System.IO.File.AppendAllText(free_vod_xml, String.Format("<Asset xsi:type=""terms:TermsType"" uriId=""irdeto.com/Terms/{0:S}Preview"" providerVersionNum=""12"" internalVersionNum=""12"" creationDateTime=""2016-08-30T00:00:00Z"" startDateTime=""2015-03-25T00:00:00Z"" endDateTime=""2020-12-31T00:00:00Z""><terms:ContractName>ClearPreview</terms:ContractName><terms:SuggestedPrice xml:lang=""01"">0.00</terms:SuggestedPrice></Asset>" & Environment.NewLine & "", TextBox1.Text))
		End If

		If CheckBox1.Checked Then
			System.IO.File.AppendAllText(free_vod_xml, String.Format("<Asset xsi:type=""offer:ContentGroupType"" uriId=""irdeto.com/ContentGroup/{0:S}"" startDateTime=""2015-03-25T00:00:00Z"" endDateTime=""2020-12-31T00:00:00Z""><offer:TitleRef uriId=""irdeto.com/Title/{0:S}"" /><offer:MovieRef uriId=""irdeto.com/Movie/{0:S}"" /><offer:PreviewRef uriId=""irdeto.com/Preview/{0:S}"" /><offer:BoxCoverRef uriId=""irdeto.com/BoxCover/{0:S}"" /><offer:PosterRef uriId=""irdeto.com/Poster/{0:S}"" /></Asset>" & Environment.NewLine & "", TextBox1.Text))
		Else
			System.IO.File.AppendAllText(free_vod_xml, String.Format("<Asset xsi:type=""offer:ContentGroupType"" uriId=""irdeto.com/ContentGroup/{0:S}"" startDateTime=""2015-03-25T00:00:00Z"" endDateTime=""2020-12-31T00:00:00Z""><offer:TitleRef uriId=""irdeto.com/Title/{0:S}"" /><offer:MovieRef uriId=""irdeto.com/Movie/{0:S}"" /><offer:BoxCoverRef uriId=""irdeto.com/BoxCover/{0:S}"" /><offer:PosterRef uriId=""irdeto.com/Poster/{0:S}"" /></Asset>" & Environment.NewLine & "", TextBox1.Text))
		End If

		System.IO.File.AppendAllText(free_vod_xml, String.Format("<Asset xsi:type=""title:TitleType"" uriId=""irdeto.com/Title/{0:S}""><title:LocalizableTitle xml:lang=""en-US""><title:TitleSortName>{0:S}</title:TitleSortName><title:TitleBrief>{0:S}</title:TitleBrief><title:TitleMedium>{0:S}</title:TitleMedium><title:TitleLong>{0:S}</title:TitleLong><title:SummaryShort>{0:S} mining season begins in Dawson City, Yukon. Three of the miners cannot get their sluice machines to run. Will this season be a bust for them? Cast: Ken Foy, Al Mc Gregor.Dir; Simon Schneider. Real Life Documentary, Canada 2014.</title:SummaryShort><title:SummaryMedium>This series follows four or five placer mining crews as they search for {0:S} over the four-month Yukon mining season. {0:S} mining season begins in Dawson City, Yukon, and the countdown to winter is on. With the price of {0:S} hovering at record-breaking levels, a modern day {0:S} rush is underway. Rookie ""Big Al"" has qualms when his excavator ""Big Girl"" breaks down and meets with disaster. In Moose Creek, bosom buddies Ken and Guillaume cannot even get their sluicer machine ""The Beast"" to start. Meanwhile, Bernie struggles with an inexperienced crew- his young sons while he teaches them how to be miners. Due to the unexpected mechanical breakdowns, could the entire mining season be a bust? Cast: Ken Foy, Al Mc Gregor.Dir; Simon Schneider. Real Life Documentary, Canada 2014.</title:SummaryMedium><title:SummaryLong>This series follows four or five placer mining crews as they search for {0:S} over the four-month Yukon mining season. {0:S} mining season begins in Dawson City, Yukon, and the countdown to winter is on. With the price of {0:S} hovering at record-breaking levels, a modern day {0:S} rush is underway. Rookie ""Big Al"" has qualms when his excavator ""Big Girl"" breaks down and meets with disaster. In Moose Creek, bosom buddies Ken and Guillaume cannot even get their sluicer machine ""The Beast"" to start. Meanwhile, Bernie struggles with an inexperienced crew- his young sons while he teaches them how to be miners. Due to the unexpected mechanical breakdowns, could the entire mining season be a bust? Cast: Ken Foy, Al Mc Gregor.Dir; Simon Schneider. Real Life Documentary, Canada 2014.</title:SummaryLong><title:Actor fullName=""Ken Foy"" firstName=""Ken"" lastName=""Foy"" sortableName=""Ken,Foy"" /><title:Actor fullName=""Al Mc Gregor"" firstName=""Al"" lastName=""Mc Gregor"" sortableName=""Al,Mc Gregor"" /><title:Director fullName=""Simon Schneider"" firstName=""Simon"" lastName=""Schneider"" sortableName=""Simon,Schneider"" /><title:Producer fullName=""Audrey Mehler"" firstName=""Audrey"" lastName=""Mehler"" sortableName=""Audrey,Mehler"" /></title:LocalizableTitle><title:LocalizableTitle xml:lang=""hi_IN""><title:TitleSortName>{0:S}</title:TitleSortName><title:TitleBrief>{0:S}</title:TitleBrief><title:TitleMedium>{0:S}</title:TitleMedium><title:TitleLong>{0:S}</title:TitleLong><title:SummaryShort>{0:S} mining season begins in Dawson City, Yukon. Three of the miners cannot get their sluice machines to run. Will this season be a bust for them? Cast: Ken Foy, Al Mc Gregor.Dir; Simon Schneider. Real Life Documentary, Canada 2014.</title:SummaryShort><title:SummaryMedium>This series follows four or five placer mining crews as they search for {0:S} over the four-month Yukon mining season. {0:S} mining season begins in Dawson City, Yukon, and the countdown to winter is on. With the price of {0:S} hovering at record-breaking levels, a modern day {0:S} rush is underway. Rookie ""Big Al"" has qualms when his excavator ""Big Girl"" breaks down and meets with disaster. In Moose Creek, bosom buddies Ken and Guillaume cannot even get their sluicer machine ""The Beast"" to start. Meanwhile, Bernie struggles with an inexperienced crew- his young sons while he teaches them how to be miners. Due to the unexpected mechanical breakdowns, could the entire mining season be a bust? Cast: Ken Foy, Al Mc Gregor.Dir; Simon Schneider. Real Life Documentary, Canada 2014.</title:SummaryMedium><title:SummaryLong>This series follows four or five placer mining crews as they search for {0:S} over the four-month Yukon mining season. {0:S} mining season begins in Dawson City, Yukon, and the countdown to winter is on. With the price of {0:S} hovering at record-breaking levels, a modern day {0:S} rush is underway. Rookie ""Big Al"" has qualms when his excavator ""Big Girl"" breaks down and meets with disaster. In Moose Creek, bosom buddies Ken and Guillaume cannot even get their sluicer machine ""The Beast"" to start. Meanwhile, Bernie struggles with an inexperienced crew- his young sons while he teaches them how to be miners. Due to the unexpected mechanical breakdowns, could the entire mining season be a bust? Cast: Ken Foy, Al Mc Gregor.Dir; Simon Schneider. Real Life Documentary, Canada 2014.</title:SummaryLong><title:Actor fullName=""Ken Foy"" firstName=""Ken"" lastName=""Foy"" sortableName=""Ken,Foy"" /><title:Actor fullName=""Al Mc Gregor"" firstName=""Al"" lastName=""Mc Gregor"" sortableName=""Al,Mc Gregor"" /><title:Director fullName=""Simon Schneider"" firstName=""Simon"" lastName=""Schneider"" sortableName=""Simon,Schneider"" /><title:Producer fullName=""Audrey Mehler"" firstName=""Audrey"" lastName=""Mehler"" sortableName=""Audrey,Mehler"" /></title:LocalizableTitle>" & Environment.NewLine & "", TextBox1.Text))


		System.IO.File.AppendAllText(free_vod_xml, String.Format("<title:Rating ratingSystem=""MPAA"">{0:S}</title:Rating><title:MSORating>0</title:MSORating><title:IsClosedCaptioning>False</title:IsClosedCaptioning><title:DisplayRunTime>00:42:52</title:DisplayRunTime><title:Year>2014</title:Year><title:IsSeasonPremier>true</title:IsSeasonPremier><title:IsSeasonFinale>true</title:IsSeasonFinale><title:EpisodeName>{1:S}</title:EpisodeName><title:EpisodeID>{2:S}</title:EpisodeID><title:NDSOfferID>{3:S}</title:NDSOfferID><title:NDSPrice>{4:S}</title:NDSPrice><title:isDownloadable>true</title:isDownloadable><title:isHD>true</title:isHD><title:DownloadExpiry>7</title:DownloadExpiry><title:RentalExpiry>{5:S}</title:RentalExpiry><title:Keywords>Yukon Gold E01, Entertainment, 2014, Ken Foy, Al Mc Gregor, Simon Schneider, Audrey Mehler</title:Keywords><title:CountryOfOrigin>Canada</title:CountryOfOrigin><title:ContentCategory>Default</title:ContentCategory><title:Genre>{6:S}</title:Genre><title:Languages>English</title:Languages><title:ShowType>{7:S}</title:ShowType><title:availablePlatform>All</title:availablePlatform><title:MaxConcurrentStreams>{8:S}</title:MaxConcurrentStreams><core:Provider>Tatasky</core:Provider></Asset>" & Environment.NewLine & "", TextBox3.Text, TextBox4.Text, TextBox5.Text, TextBox6.Text, TextBox7.Text, TextBox8.Text, TextBox9.Text, TextBox10.Text, TextBox11.Text))


		System.IO.File.AppendAllText(free_vod_xml, String.Format("<Asset xsi:type=""content:MovieType"" uriId=""irdeto.com/Movie/{0:S}"" providerVersionNum=""12"" internalVersionNum=""12"" creationDateTime=""2016-08-30T00:00:00Z"" startDateTime=""2015-03-25T00:00:00Z"" endDateTime=""2020-12-31T00:00:00Z""><content:SourceUrl>{0:S}.mp4</content:SourceUrl><content:ContentFileSize>2576877</content:ContentFileSize><content:ContentCheckSum>07C6E64C78D8400BC04A433A0B9E9023</content:ContentCheckSum><content:AudioType>Stereo</content:AudioType><content:ScreenFormat>Standard</content:ScreenFormat><content:Duration>PT00H42M52S</content:Duration><content:Language>en_US</content:Language><content:SubtitleLanguage>es</content:SubtitleLanguage><content:DubbedLanguage>es</content:DubbedLanguage><content:Rating ratingSystem=""MPAA"">U</content:Rating><Ext xsi:type=""irdeto:VideoSubContentType"" uriId=""irdeto.com/Movie/{0:S}"" providerVersionNum=""12"" internalVersionNum=""12"" creationDateTime=""2016-08-30T00:00:00Z"" startDateTime=""2015-03-25T00:00:00Z"" endDateTime=""2020-12-31T00:00:00Z""><content:SourceUrl>{0:S}.mp4</content:SourceUrl><irdeto:TranscodeProfile>SmoothStream Multi-Bitrate</irdeto:TranscodeProfile><content:ContentFileSize>2576877</content:ContentFileSize><content:ContentCheckSum>07C6E64C78D8400BC04A433A0B9E9023</content:ContentCheckSum><content:Resolution>1080</content:Resolution><content:FrameRate>60</content:FrameRate><content:Codec>MPEG2</content:Codec><content:BitRate>1024</content:BitRate><content:ElementalDeltaIP>{1:S}</content:ElementalDeltaIP><content:CdnVODUrlPrefix>https://delta{2:S}tatasky.akamaized.net</content:CdnVODUrlPrefix></Ext></Asset>" & Environment.NewLine & "", TextBox1.Text, TextBox12.Text, TextBox13.Text))


		If CheckBox1.Checked Then
			System.IO.File.AppendAllText(free_vod_xml, String.Format("<Asset xsi:type=""content:PreviewType"" uriId=""irdeto.com/Preview/{0:S}"" providerVersionNum=""12"" internalVersionNum=""12"" creationDateTime=""2016-08-30T00:00:00Z"" startDateTime=""2015-03-25T00:00:00Z"" endDateTime=""2020-12-31T00:00:00Z""><content:SourceUrl>{0:S}P.mp4</content:SourceUrl><content:ContentFileSize>2576877</content:ContentFileSize><content:ContentCheckSum>07C6E64C78D8400BC04A433A0B9E9023</content:ContentCheckSum><content:AudioType>Stereo</content:AudioType><content:ScreenFormat>Standard</content:ScreenFormat><content:Duration>PT00H42M52S</content:Duration><content:Language>en_US</content:Language><content:SubtitleLanguage>es</content:SubtitleLanguage><content:DubbedLanguage>es</content:DubbedLanguage><content:Rating ratingSystem=""MPAA"">U</content:Rating><Ext xsi:type=""irdeto:VideoSubContentType"" uriId=""irdeto.com/Preview/{0:S}"" providerVersionNum=""12"" internalVersionNum=""12"" creationDateTime=""2016-08-30T00:00:00Z"" startDateTime=""2015-03-25T00:00:00Z"" endDateTime=""2020-12-31T00:00:00Z""><content:SourceUrl>{0:S}P.mp4</content:SourceUrl><irdeto:TranscodeProfile>SmoothStream Multi-Bitrate</irdeto:TranscodeProfile><content:ContentFileSize>2576877</content:ContentFileSize><content:ContentCheckSum>07C6E64C78D8400BC04A433A0B9E9023</content:ContentCheckSum><content:Resolution>1080</content:Resolution><content:FrameRate>60</content:FrameRate><content:Codec>MPEG2</content:Codec><content:BitRate>1024</content:BitRate><content:ElementalDeltaIP>{1:S}</content:ElementalDeltaIP><content:CdnVODUrlPrefix>https://delta{2:S}tatasky.akamaized.net</content:CdnVODUrlPrefix></Ext></Asset>" & Environment.NewLine & "", TextBox1.Text, TextBox12.Text, TextBox13.Text))
		End If

		System.IO.File.AppendAllText(free_vod_xml, String.Format("<Asset xsi:type=""content:BoxCoverType"" uriId=""irdeto.com/BoxCover/{0:S}"" providerVersionNum=""12"" internalVersionNum=""12"" creationDateTime=""2016-08-30T00:00:00Z"" startDateTime=""2015-03-25T00:00:00Z"" endDateTime=""2020-12-31T00:00:00Z""><content:SourceUrl>{0:S}_BoxCover.png</content:SourceUrl><content:ContentFileSize>40963</content:ContentFileSize><content:ContentCheckSum>3B4E5F9DDCD4809E9C5F1794C00516ED</content:ContentCheckSum><content:X_Resolution>285</content:X_Resolution><content:Y_Resolution>160</content:Y_Resolution></Asset><Asset xsi:type=""content:PosterType"" uriId=""irdeto.com/Poster/{0:S}"" providerVersionNum=""12"" internalVersionNum=""12"" creationDateTime=""2016-08-30T00:00:00Z"" startDateTime=""2015-03-25T00:00:00Z"" endDateTime=""2020-12-31T00:00:00Z""><content:SourceUrl>{0:S}_Poster.png</content:SourceUrl><content:ContentFileSize>43664</content:ContentFileSize><content:ContentCheckSum>FF529E02ECF8A957304E1A4374BFB342</content:ContentCheckSum><content:X_Resolution>106</content:X_Resolution><content:Y_Resolution>163</content:Y_Resolution></Asset></ADI3>" & Environment.NewLine & "", TextBox1.Text))

		PictureBox1.Image.Save(String.Format(folderpath + "\" & TextBox1.Text & "_BoxCover.png"))
		PictureBox2.Image.Save(String.Format(folderpath + "\" & TextBox1.Text & "_Poster.png"))

		Dim allcontent As String = System.IO.File.ReadAllText(free_vod_xml)
		System.IO.File.WriteAllText(free_vod_xml, PrettyXML(allcontent))

	End Sub

	Private Function PrettyXML(XMLString As String) As String
		Dim sw As New StringWriter()
		Dim xw As New XmlTextWriter(sw)
		xw.Formatting = Formatting.Indented
		xw.Indentation = 4
		Dim doc As New XmlDocument
		doc.LoadXml(XMLString)
		doc.Save(xw)
		Return sw.ToString()
	End Function

	Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
		Dim folderpath As String
		If TextBox14.Text.Length = 0 Then
			Dim result As DialogResult = FolderBrowserDialog1.ShowDialog()
			folderpath = FolderBrowserDialog1.SelectedPath()
			TextBox14.Text = FolderBrowserDialog1.SelectedPath()
			'MessageBox.Show(folderpath)
		Else
			folderpath = TextBox14.Text
		End If
		Dim free_vod_xml As String = folderpath + "\" & TextBox1.Text & ".xml"
		Dim Subscription_xml As String = folderpath + "\" & TextBox1.Text & "_sub" & ".xml"

		'SVOD xml creation starting
		System.IO.File.WriteAllText(free_vod_xml, "<?xml version=""1.0"" encoding=""UTF-8""?><ADI3 xmlns=""urn:cablelabs:md:xsd:core:3.0"" xmlns:content=""urn:cablelabs:md:xsd:content:3.0"" xmlns:core=""urn:cablelabs:md:xsd:core:3.0"" xmlns:offer=""urn:cablelabs:md:xsd:offer:3.0"" xmlns:terms=""urn:cablelabs:md:xsd:terms:3.0"" xmlns:title=""urn:cablelabs:md:xsd:title:3.0"" xmlns:irdeto=""http://www.irdeto.com/schemas/metadata/1.0"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xsi:schemaLocation=""urn:cablelabs:md:xsd:core:3.0 MD-SP-CORE-I02.xsd urn:cablelabs:md:xsd:offer:3.0 MD-SP-OFFER-I02.xsd urn:cablelabs:md:xsd:title:3.0 MD-SP-TITLE-I02.xsd urn:cablelabs:md:xsd:content:3.0 MD-SP-CONTENT-I02.xsd urn:cablelabs:md:xsd:terms:3.0 MD-SP-TERMS-I02.xsd http://www.irdeto.com/schemas/metadata/1.0 Irdeto-ADI-3_0-extension.xsd"">" & Environment.NewLine & "")

		If CheckBox1.Checked Then
			System.IO.File.AppendAllText(free_vod_xml, String.Format("<Asset xsi:type=""offer:ContentGroupType"" uriId=""irdeto.com/ContentGroup/{0:S}"" startDateTime=""2015-03-25T00:00:00Z"" endDateTime=""2020-12-31T00:00:00Z""><offer:TitleRef uriId=""irdeto.com/Title/{0:S}"" /><offer:MovieRef uriId=""irdeto.com/Movie/{0:S}"" /><offer:PreviewRef uriId=""irdeto.com/Preview/{0:S}"" /><offer:BoxCoverRef uriId=""irdeto.com/BoxCover/{0:S}"" /><offer:PosterRef uriId=""irdeto.com/Poster/{0:S}"" /></Asset>" & Environment.NewLine & "", TextBox1.Text))
		Else
			System.IO.File.AppendAllText(free_vod_xml, String.Format("<Asset xsi:type=""offer:ContentGroupType"" uriId=""irdeto.com/ContentGroup/{0:S}"" startDateTime=""2015-03-25T00:00:00Z"" endDateTime=""2020-12-31T00:00:00Z""><offer:TitleRef uriId=""irdeto.com/Title/{0:S}"" /><offer:MovieRef uriId=""irdeto.com/Movie/{0:S}"" /><offer:BoxCoverRef uriId=""irdeto.com/BoxCover/{0:S}"" /><offer:PosterRef uriId=""irdeto.com/Poster/{0:S}"" /></Asset>" & Environment.NewLine & "", TextBox1.Text))
		End If

		System.IO.File.AppendAllText(free_vod_xml, String.Format("<Asset xsi:type=""title:TitleType"" uriId=""irdeto.com/Title/{0:S}""><title:LocalizableTitle xml:lang=""en-US""><title:TitleSortName>{0:S}</title:TitleSortName><title:TitleBrief>{0:S}</title:TitleBrief><title:TitleMedium>{0:S}</title:TitleMedium><title:TitleLong>{0:S}</title:TitleLong><title:SummaryShort>{0:S} mining season begins in Dawson City, Yukon. Three of the miners cannot get their sluice machines to run. Will this season be a bust for them? Cast: Ken Foy, Al Mc Gregor.Dir; Simon Schneider. Real Life Documentary, Canada 2014.</title:SummaryShort><title:SummaryMedium>This series follows four or five placer mining crews as they search for {0:S} over the four-month Yukon mining season. {0:S} mining season begins in Dawson City, Yukon, and the countdown to winter is on. With the price of {0:S} hovering at record-breaking levels, a modern day {0:S} rush is underway. Rookie ""Big Al"" has qualms when his excavator ""Big Girl"" breaks down and meets with disaster. In Moose Creek, bosom buddies Ken and Guillaume cannot even get their sluicer machine ""The Beast"" to start. Meanwhile, Bernie struggles with an inexperienced crew- his young sons while he teaches them how to be miners. Due to the unexpected mechanical breakdowns, could the entire mining season be a bust? Cast: Ken Foy, Al Mc Gregor.Dir; Simon Schneider. Real Life Documentary, Canada 2014.</title:SummaryMedium><title:SummaryLong>This series follows four or five placer mining crews as they search for {0:S} over the four-month Yukon mining season. {0:S} mining season begins in Dawson City, Yukon, and the countdown to winter is on. With the price of {0:S} hovering at record-breaking levels, a modern day {0:S} rush is underway. Rookie ""Big Al"" has qualms when his excavator ""Big Girl"" breaks down and meets with disaster. In Moose Creek, bosom buddies Ken and Guillaume cannot even get their sluicer machine ""The Beast"" to start. Meanwhile, Bernie struggles with an inexperienced crew- his young sons while he teaches them how to be miners. Due to the unexpected mechanical breakdowns, could the entire mining season be a bust? Cast: Ken Foy, Al Mc Gregor.Dir; Simon Schneider. Real Life Documentary, Canada 2014.</title:SummaryLong><title:Actor fullName=""Ken Foy"" firstName=""Ken"" lastName=""Foy"" sortableName=""Ken,Foy"" /><title:Actor fullName=""Al Mc Gregor"" firstName=""Al"" lastName=""Mc Gregor"" sortableName=""Al,Mc Gregor"" /><title:Director fullName=""Simon Schneider"" firstName=""Simon"" lastName=""Schneider"" sortableName=""Simon,Schneider"" /><title:Producer fullName=""Audrey Mehler"" firstName=""Audrey"" lastName=""Mehler"" sortableName=""Audrey,Mehler"" /></title:LocalizableTitle><title:LocalizableTitle xml:lang=""hi_IN""><title:TitleSortName>{0:S}</title:TitleSortName><title:TitleBrief>{0:S}</title:TitleBrief><title:TitleMedium>{0:S}</title:TitleMedium><title:TitleLong>{0:S}</title:TitleLong><title:SummaryShort>{0:S} mining season begins in Dawson City, Yukon. Three of the miners cannot get their sluice machines to run. Will this season be a bust for them? Cast: Ken Foy, Al Mc Gregor.Dir; Simon Schneider. Real Life Documentary, Canada 2014.</title:SummaryShort><title:SummaryMedium>This series follows four or five placer mining crews as they search for {0:S} over the four-month Yukon mining season. {0:S} mining season begins in Dawson City, Yukon, and the countdown to winter is on. With the price of {0:S} hovering at record-breaking levels, a modern day {0:S} rush is underway. Rookie ""Big Al"" has qualms when his excavator ""Big Girl"" breaks down and meets with disaster. In Moose Creek, bosom buddies Ken and Guillaume cannot even get their sluicer machine ""The Beast"" to start. Meanwhile, Bernie struggles with an inexperienced crew- his young sons while he teaches them how to be miners. Due to the unexpected mechanical breakdowns, could the entire mining season be a bust? Cast: Ken Foy, Al Mc Gregor.Dir; Simon Schneider. Real Life Documentary, Canada 2014.</title:SummaryMedium><title:SummaryLong>This series follows four or five placer mining crews as they search for {0:S} over the four-month Yukon mining season. {0:S} mining season begins in Dawson City, Yukon, and the countdown to winter is on. With the price of {0:S} hovering at record-breaking levels, a modern day {0:S} rush is underway. Rookie ""Big Al"" has qualms when his excavator ""Big Girl"" breaks down and meets with disaster. In Moose Creek, bosom buddies Ken and Guillaume cannot even get their sluicer machine ""The Beast"" to start. Meanwhile, Bernie struggles with an inexperienced crew- his young sons while he teaches them how to be miners. Due to the unexpected mechanical breakdowns, could the entire mining season be a bust? Cast: Ken Foy, Al Mc Gregor.Dir; Simon Schneider. Real Life Documentary, Canada 2014.</title:SummaryLong><title:Actor fullName=""Ken Foy"" firstName=""Ken"" lastName=""Foy"" sortableName=""Ken,Foy"" /><title:Actor fullName=""Al Mc Gregor"" firstName=""Al"" lastName=""Mc Gregor"" sortableName=""Al,Mc Gregor"" /><title:Director fullName=""Simon Schneider"" firstName=""Simon"" lastName=""Schneider"" sortableName=""Simon,Schneider"" /><title:Producer fullName=""Audrey Mehler"" firstName=""Audrey"" lastName=""Mehler"" sortableName=""Audrey,Mehler"" /></title:LocalizableTitle>" & Environment.NewLine & "", TextBox1.Text))


		System.IO.File.AppendAllText(free_vod_xml, String.Format("<title:Rating ratingSystem=""MPAA"">{0:S}</title:Rating><title:MSORating>0</title:MSORating><title:IsClosedCaptioning>False</title:IsClosedCaptioning><title:DisplayRunTime>00:42:52</title:DisplayRunTime><title:Year>2014</title:Year><title:IsSeasonPremier>true</title:IsSeasonPremier><title:IsSeasonFinale>true</title:IsSeasonFinale><title:EpisodeName>{1:S}</title:EpisodeName><title:EpisodeID>{2:S}</title:EpisodeID><title:NDSOfferID>{3:S}</title:NDSOfferID><title:NDSPrice>{4:S}</title:NDSPrice><title:isDownloadable>true</title:isDownloadable><title:isHD>true</title:isHD><title:DownloadExpiry>7</title:DownloadExpiry><title:RentalExpiry>{5:S}</title:RentalExpiry><title:Keywords>Yukon Gold E01, Entertainment, 2014, Ken Foy, Al Mc Gregor, Simon Schneider, Audrey Mehler</title:Keywords><title:CountryOfOrigin>Canada</title:CountryOfOrigin><title:ContentCategory>Default</title:ContentCategory><title:Genre>{6:S}</title:Genre><title:Languages>English</title:Languages><title:ShowType>{7:S}</title:ShowType><title:availablePlatform>All</title:availablePlatform><title:MaxConcurrentStreams>{8:S}</title:MaxConcurrentStreams><core:Provider>Tatasky</core:Provider></Asset>" & Environment.NewLine & "", TextBox3.Text, TextBox4.Text, TextBox5.Text, TextBox6.Text, TextBox7.Text, TextBox8.Text, TextBox9.Text, TextBox10.Text, TextBox11.Text))

		System.IO.File.AppendAllText(free_vod_xml, String.Format("<Asset xsi:type=""content:MovieType"" uriId=""irdeto.com/Movie/{0:S}"" providerVersionNum=""12"" internalVersionNum=""12"" creationDateTime=""2016-08-30T00:00:00Z"" startDateTime=""2015-03-25T00:00:00Z"" endDateTime=""2020-12-31T00:00:00Z""><content:SourceUrl>{0:S}.mp4</content:SourceUrl><content:ContentFileSize>2576877</content:ContentFileSize><content:ContentCheckSum>07C6E64C78D8400BC04A433A0B9E9023</content:ContentCheckSum><content:AudioType>Stereo</content:AudioType><content:ScreenFormat>Standard</content:ScreenFormat><content:Duration>PT00H42M52S</content:Duration><content:Language>en_US</content:Language><content:SubtitleLanguage>es</content:SubtitleLanguage><content:DubbedLanguage>es</content:DubbedLanguage><content:Rating ratingSystem=""MPAA"">U</content:Rating><Ext xsi:type=""irdeto:VideoSubContentType"" uriId=""irdeto.com/Movie/{0:S}"" providerVersionNum=""12"" internalVersionNum=""12"" creationDateTime=""2016-08-30T00:00:00Z"" startDateTime=""2015-03-25T00:00:00Z"" endDateTime=""2020-12-31T00:00:00Z""><content:SourceUrl>{0:S}.mp4</content:SourceUrl><irdeto:TranscodeProfile>SmoothStream Multi-Bitrate</irdeto:TranscodeProfile><content:ContentFileSize>2576877</content:ContentFileSize><content:ContentCheckSum>07C6E64C78D8400BC04A433A0B9E9023</content:ContentCheckSum><content:Resolution>1080</content:Resolution><content:FrameRate>60</content:FrameRate><content:Codec>MPEG2</content:Codec><content:BitRate>1024</content:BitRate><content:ElementalDeltaIP>{1:S}</content:ElementalDeltaIP><content:CdnVODUrlPrefix>https://delta{2:S}tatasky.akamaized.net</content:CdnVODUrlPrefix></Ext></Asset>" & Environment.NewLine & "", TextBox1.Text, TextBox12.Text, TextBox13.Text))


		If CheckBox1.Checked Then
			System.IO.File.AppendAllText(free_vod_xml, String.Format("<Asset xsi:type=""content:PreviewType"" uriId=""irdeto.com/Preview/{0:S}"" providerVersionNum=""12"" internalVersionNum=""12"" creationDateTime=""2016-08-30T00:00:00Z"" startDateTime=""2015-03-25T00:00:00Z"" endDateTime=""2020-12-31T00:00:00Z""><content:SourceUrl>{0:S}P.mp4</content:SourceUrl><content:ContentFileSize>2576877</content:ContentFileSize><content:ContentCheckSum>07C6E64C78D8400BC04A433A0B9E9023</content:ContentCheckSum><content:AudioType>Stereo</content:AudioType><content:ScreenFormat>Standard</content:ScreenFormat><content:Duration>PT00H42M52S</content:Duration><content:Language>en_US</content:Language><content:SubtitleLanguage>es</content:SubtitleLanguage><content:DubbedLanguage>es</content:DubbedLanguage><content:Rating ratingSystem=""MPAA"">U</content:Rating><Ext xsi:type=""irdeto:VideoSubContentType"" uriId=""irdeto.com/Preview/{0:S}"" providerVersionNum=""12"" internalVersionNum=""12"" creationDateTime=""2016-08-30T00:00:00Z"" startDateTime=""2015-03-25T00:00:00Z"" endDateTime=""2020-12-31T00:00:00Z""><content:SourceUrl>{0:S}P.mp4</content:SourceUrl><irdeto:TranscodeProfile>SmoothStream Multi-Bitrate</irdeto:TranscodeProfile><content:ContentFileSize>2576877</content:ContentFileSize><content:ContentCheckSum>07C6E64C78D8400BC04A433A0B9E9023</content:ContentCheckSum><content:Resolution>1080</content:Resolution><content:FrameRate>60</content:FrameRate><content:Codec>MPEG2</content:Codec><content:BitRate>1024</content:BitRate><content:ElementalDeltaIP>{1:S}</content:ElementalDeltaIP><content:CdnVODUrlPrefix>https://delta{2:S}tatasky.akamaized.net</content:CdnVODUrlPrefix></Ext></Asset>" & Environment.NewLine & "", TextBox1.Text, TextBox12.Text, TextBox13.Text))
		End If

		System.IO.File.AppendAllText(free_vod_xml, String.Format("<Asset xsi:type=""content:BoxCoverType"" uriId=""irdeto.com/BoxCover/{0:S}"" providerVersionNum=""12"" internalVersionNum=""12"" creationDateTime=""2016-08-30T00:00:00Z"" startDateTime=""2015-03-25T00:00:00Z"" endDateTime=""2020-12-31T00:00:00Z""><content:SourceUrl>{0:S}_BoxCover.png</content:SourceUrl><content:ContentFileSize>40963</content:ContentFileSize><content:ContentCheckSum>3B4E5F9DDCD4809E9C5F1794C00516ED</content:ContentCheckSum><content:X_Resolution>285</content:X_Resolution><content:Y_Resolution>160</content:Y_Resolution></Asset><Asset xsi:type=""content:PosterType"" uriId=""irdeto.com/Poster/{0:S}"" providerVersionNum=""12"" internalVersionNum=""12"" creationDateTime=""2016-08-30T00:00:00Z"" startDateTime=""2015-03-25T00:00:00Z"" endDateTime=""2020-12-31T00:00:00Z""><content:SourceUrl>{0:S}_Poster.png</content:SourceUrl><content:ContentFileSize>43664</content:ContentFileSize><content:ContentCheckSum>FF529E02ECF8A957304E1A4374BFB342</content:ContentCheckSum><content:X_Resolution>106</content:X_Resolution><content:Y_Resolution>163</content:Y_Resolution></Asset></ADI3>" & Environment.NewLine & "", TextBox1.Text))

		'Subscription XML creation starting
		System.IO.File.WriteAllText(Subscription_xml, "<?xml version=""1.0"" encoding=""UTF-8""?><ADI3 xmlns=""urn:cablelabs:md:xsd:core:3.0"" xmlns:content=""urn:cablelabs:md:xsd:content:3.0"" xmlns:core=""urn:cablelabs:md:xsd:core:3.0"" xmlns:offer=""urn:cablelabs:md:xsd:offer:3.0"" xmlns:terms=""urn:cablelabs:md:xsd:terms:3.0"" xmlns:title=""urn:cablelabs:md:xsd:title:3.0"" xmlns:irdeto=""http://www.irdeto.com/schemas/metadata/1.0"" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"" xsi:schemaLocation=""urn:cablelabs:md:xsd:core:3.0 MD-SP-CORE-I02.xsd urn:cablelabs:md:xsd:offer:3.0 MD-SP-OFFER-I02.xsd urn:cablelabs:md:xsd:title:3.0 MD-SP-TITLE-I02.xsd urn:cablelabs:md:xsd:content:3.0 MD-SP-CONTENT-I02.xsd urn:cablelabs:md:xsd:terms:3.0 MD-SP-TERMS-I02.xsd http://www.irdeto.com/schemas/metadata/1.0 Irdeto-ADI-3_0-extension.xsd"">" & Environment.NewLine & "")

		System.IO.File.AppendAllText(Subscription_xml, String.Format("<Asset xsi:type=""offer:OfferType"" uriId=""irdeto.com/Offer/{0:S}Movie"" providerVersionNum=""12"" internalVersionNum=""12"" creationDateTime= ""2016-08-30T00:00:00Z"" startDateTime=""2015-03-25T00:00:00Z"" endDateTime=""2020-12-31T00:00:00Z"">" & Environment.NewLine & "", TextBox1.Text))

		System.IO.File.AppendAllText(Subscription_xml, String.Format("<offer:PromotionalContentGroupRef uriId=""irdeto.com/SubscriptionPackage/{0:S}"" /><offer:ProviderContentTier>PDL Economy</offer:ProviderContentTier><offer:BillingId>10015</offer:BillingId><offer:TermsRef uriId=""irdeto.com/Terms/{0:S}Movie"" /><offer:ContentGroupRef uriId=""irdeto.com/SubscriptionPackage/{0:S}"" /></Asset>" & Environment.NewLine & "", TextBox1.Text))

		If CheckBox1.Checked Then
			System.IO.File.AppendAllText(Subscription_xml, String.Format("<Asset xsi:type=""offer:OfferType"" uriId=""irdeto.com/Offer/{0:S}Preview"" providerVersionNum=""12"" internalVersionNum=""12"" creationDateTime= ""2016-08-30T00:00:00Z"" startDateTime=""2015-03-25T00:00:00Z"" endDateTime=""2020-12-31T00:00:00Z"">" & Environment.NewLine & "", TextBox1.Text))

			System.IO.File.AppendAllText(Subscription_xml, String.Format("<offer:PromotionalContentGroupRef uriId=""irdeto.com/SubscriptionPackage/{0:S}"" /><offer:ProviderContentTier>PDL Economy</offer:ProviderContentTier><offer:BillingId>10015</offer:BillingId><offer:TermsRef uriId=""irdeto.com/Terms/{0:S}Preview"" /><offer:ContentGroupRef uriId=""irdeto.com/SubscriptionPackage/{0:S}"" /></Asset>" & Environment.NewLine & "", TextBox1.Text))
		End If

		System.IO.File.AppendAllText(Subscription_xml, String.Format("<Asset xsi:type=""terms:TermsType"" uriId=""irdeto.com/Terms/{0:S}Movie"" providerVersionNum=""12"" internalVersionNum=""12"" creationDateTime=""2016-08-30T00:00:00Z"" startDateTime=""2015-03-25T00:00:00Z"" endDateTime=""2020-12-31T00:00:00Z""><terms:ContractName>{1:S}</terms:ContractName><terms:SuggestedPrice xml:lang=""01"">10.00</terms:SuggestedPrice></Asset>" & Environment.NewLine & "", TextBox1.Text, TextBox2.Text))

		If CheckBox1.Checked Then
			System.IO.File.AppendAllText(Subscription_xml, String.Format("<Asset xsi:type=""terms:TermsType"" uriId=""irdeto.com/Terms/{0:S}Preview"" providerVersionNum=""12"" internalVersionNum=""12"" creationDateTime=""2016-08-30T00:00:00Z"" startDateTime=""2015-03-25T00:00:00Z"" endDateTime=""2020-12-31T00:00:00Z""><terms:ContractName>ClearPreview</terms:ContractName><terms:SuggestedPrice xml:lang=""01"">0.00</terms:SuggestedPrice></Asset>" & Environment.NewLine & "", TextBox1.Text))
		End If

		System.IO.File.AppendAllText(Subscription_xml, String.Format("<Asset xsi:type=""irdeto:SubscriptionPackageType"" uriId=""irdeto.com/SubscriptionPackage/{0:S}"" startDateTime=""2015-03-25T00:00:00Z"" endDateTime=""2020-12-31T00:00:00Z""><irdeto:TitleRef uriId=""irdeto.com/Title/SubscriptionPackage/{0:S}"" /><irdeto:ContentGroupRef uriId=""irdeto.com/ContentGroup/{0:S}"" /><irdeto:SMSPackageId>17</irdeto:SMSPackageId><irdeto:Alacarte>false</irdeto:Alacarte><irdeto:isEnabled>true</irdeto:isEnabled></Asset>" & Environment.NewLine & "", TextBox1.Text))

		System.IO.File.AppendAllText(Subscription_xml, String.Format("<Asset xsi:type=""title:TitleType"" uriId=""irdeto.com/Title/SubscriptionPackage/{0:S}""><title:LocalizableTitle xml:lang=""en-US""><title:TitleSortName>{0:S} sub</title:TitleSortName><title:TitleBrief>{0:S} sub</title:TitleBrief><title:TitleMedium>{0:S} sub</title:TitleMedium><title:TitleLong>{0:S} sub</title:TitleLong><title:SummaryShort>{0:S} sub</title:SummaryShort><title:SummaryMedium>{0:S} sub</title:SummaryMedium><title:SummaryLong>{0:S} sub</title:SummaryLong></title:LocalizableTitle><title:LocalizableTitle xml:lang=""hi_IN""><title:TitleSortName>{0:S} sub</title:TitleSortName><title:TitleBrief>{0:S} sub</title:TitleBrief><title:TitleMedium>{0:S} sub</title:TitleMedium><title:TitleLong>{0:S} sub</title:TitleLong><title:SummaryShort>{0:S} sub</title:SummaryShort><title:SummaryMedium>{0:S} sub</title:SummaryMedium><title:SummaryLong>{0:S} sub</title:SummaryLong></title:LocalizableTitle>" & Environment.NewLine & "", TextBox1.Text))

		System.IO.File.AppendAllText(Subscription_xml, String.Format("<title:Keywords>Star,sports,channel</title:Keywords><title:CountryOfOrigin>Canada</title:CountryOfOrigin><title:Languages>Hindi,English,Marathi</title:Languages><title:ShowType>{0:S}</title:ShowType><core:Provider>Tatasky</core:Provider></Asset></ADI3>" & Environment.NewLine & "", TextBox10.Text))

		PictureBox1.Image.Save(String.Format(folderpath + "\" & TextBox1.Text & "_BoxCover.png"))
		PictureBox2.Image.Save(String.Format(folderpath + "\" & TextBox1.Text & "_Poster.png"))

		Dim allcontent As String = System.IO.File.ReadAllText(free_vod_xml)
		Dim allcontent_subscription As String = System.IO.File.ReadAllText(Subscription_xml)
		System.IO.File.WriteAllText(free_vod_xml, PrettyXML(allcontent))
		System.IO.File.WriteAllText(Subscription_xml, PrettyXML(allcontent_subscription))


	End Sub
End Class
